# Ralph Progress Log
Started: Initial setup
---

## Codebase Patterns
- Multi-tenant: every DB query must filter by tenantId
- Auth: NextAuth v5 with getServerSession, session includes tenantId
- tRPC routers in server/api/trpc/routers/, registered in _app.ts
- API routes (non-tRPC) in app/api/
- UI components: shadcn/ui from @/components/ui/
- Pages: app/(dashboard)/ for authenticated, app/(auth)/ for login/register
- Prisma client: import from @/lib/prisma (singleton pattern)
- Existing Subscription model in schema.prisma (line ~189)
- Registration flow: app/api/register/route.ts
- Navigation: components/navigation.tsx
- Middleware: middleware.ts (route protection)
---

## [2026-02-26 23:xx] - US-001
- Installed stripe and @stripe/stripe-js packages
- Created lib/stripe.ts with server-side Stripe client (singleton pattern, apiVersion: 2025-02-24.acacia)
- Created lib/stripe-client.ts with getStripe() helper for client-side loadStripe
- Env vars already configured in .env.local.example and .env.production.example
- Typecheck and build pass
- **Files changed:**
  - lib/stripe.ts (new)
  - lib/stripe-client.ts (new)
  - package.json (added dependencies)
  - package-lock.json
- **Learnings for future iterations:**
  - Stripe SDK requires specific apiVersion - always use latest from TypeScript types
  - Singleton pattern prevents multiple Stripe instances in dev hot reload
---
